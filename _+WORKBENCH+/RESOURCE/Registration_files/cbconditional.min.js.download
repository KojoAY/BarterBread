(function($){$.fn.cbconditional=function(options){var settings=$.extend({value:null,operator:0,input:null,direction:1,reset:0,showFields:new Array(),hideFields:new Array(),requiredIcon:null,requiredFields:new Array(),nonrequiredFields:new Array(),showOptions:new Array(),hideOptions:new Array(),showTabs:new Array(),hideTabs:new Array()},options);var fields=new Array();if($(this).length){fields=$(this).find(".fieldCell,.cb_field").find("input,select,textarea").not('[type="hidden"],[type="submit"],[type="button"]');fields.each(function(index){if($(this).attr("name").match(/_cbprivacy/i)){fields.splice(index,1)}});fields.each(function(){var field=$(this);var name=field.attr("name");if(field.attr("moslabel")=="Date"){conditionDisplay($("#"+name),fields,settings);$("#"+name+"_Month_ID,#"+name+"_Day_ID,#"+name+"_Year_ID").live("change",function(){conditionDisplay($("#"+name),fields,settings)});$(".calendarDayInput,.calendar td").live("click",function(){conditionDisplay($("#"+name),fields,settings)})}else{if(field.attr("type")=="textarea"){conditionDisplay($("#"+name+"_ifr").contents().find("html body").text(),fields,settings);if(field.attr("class").match(/edit/i)){$("#"+name+"_parent").live("click mouseenter mouseleave",function(){conditionDisplay($("#"+name+"_ifr").contents().find("html body").text(),fields,settings)})}}else{conditionDisplay(field,fields,settings)}}field.bind("keyup change",function(){conditionDisplay(field,fields,settings)})})}else{conditionDisplay(settings.value,fields,settings)}};function conditionDisplay(field,fields,settings){if(getMatch(getValue(field,fields),settings.operator,settings.input)){showFields(settings.showFields);hideFields(settings.hideFields,settings.reset);requireFields(settings.requiredFields,settings.requiredIcon);nonrequireFields(settings.nonrequiredFields);showOptions(settings.showOptions,settings.reset);hideOptions(settings.hideOptions,settings.reset);showTabs(settings.showTabs);hideTabs(settings.hideTabs,settings.reset)}else{if(settings.direction==1){showFields(settings.hideFields);hideFields(settings.showFields,settings.reset);requireFields(settings.nonrequiredFields,settings.requiredIcon);nonrequireFields(settings.requiredFields);showOptions(settings.hideOptions,settings.reset);hideOptions(settings.showOptions,settings.reset);showTabs(settings.hideTabs);hideTabs(settings.showTabs,settings.reset)}}}function showFields(fields){if(fields){for(i=0;i<fields.length;i++){var field_id=fields[i];var field=$("#cbfr_"+field_id+",#cbfrd_"+field_id+",#cbfr_"+field_id+"__verify,#cbfr_"+field_id+"__strength");var container=field.removeClass("displayDisabled").find(".fieldCell,.cb_field");container.find("input.inputDisabled,select.inputDisabled,textarea.inputDisabled").removeClass("inputDisabled").removeAttr("disabled");container.find("input.requiredDisabled,select.requiredDisabled,textarea.requiredDisabled").removeClass("requiredDisabled").addClass("required").attr("mosReq","1");disableTab(field.parent(".cbFieldsContentsTab").attr("id"))}}}function hideFields(fields,reset){if(fields){for(i=0;i<fields.length;i++){var field_id=fields[i];var field=$("#cbfr_"+field_id+",#cbfrd_"+field_id+",#cbfr_"+field_id+"__verify,#cbfr_"+field_id+"__strength");var container=field.addClass("displayDisabled").find(".fieldCell,.cb_field");var inputs=container.find("input,select,textarea").not('[type="hidden"],[type="submit"],[type="button"]');if(reset==1){inputs.val("");if(inputs.is('[type="checkbox"],[type="radio"]')){inputs.attr("checked","")}}inputs.not("disabled").addClass("inputDisabled").attr("disabled","disabled");container.find("input.required,select.required,textarea.required").removeClass("required").addClass("requiredDisabled").attr("mosReq","0");disableTab(field.parent(".cbFieldsContentsTab").attr("id"))}}}function showOptions(options,reset){var fields=new Array();if(options){for(i=0;i<options.length;i++){var option_id=options[i];var option=$("#cbf"+option_id);if(option.hasClass("optionDisabled")){var field=option.closest(".fieldCell,.cb_field");if(field.length){var shown=field.find('input,option[value!=""]');var hidden=field.find('input.optionDisabled,option[value!=""].optionDisabled');if(shown.length&&hidden.length&&(shown.length==hidden.length)){var row=field.parent();if(row.length&&row.attr("id")){var field_id=row.attr("id").replace(/cbfr_|cbfrd_|__verify|__strength/,"");if(field_id&&(fields.indexOf(field_id)==-1)){fields.push(field_id)}}}}var type=option.attr("type");if((type=="checkbox")||(type=="radio")){var parent=option.parent(".cbSnglCtrlLbl");if(parent.length){parent.removeClass("displayDisabled")}}option.removeClass("optionDisabled").removeAttr("disabled")}}}if(fields.length){showFields(fields,reset)}}function hideOptions(options,reset){var fields=new Array();if(options){for(i=0;i<options.length;i++){var option_id=options[i];var option=$("#cbf"+option_id);if(!option.hasClass("optionDisabled")){var type=option.attr("type");if((type=="checkbox")||(type=="radio")){var parent=option.parent(".cbSnglCtrlLbl");if(parent.length){parent.addClass("displayDisabled")}}option.addClass("optionDisabled").attr("disabled","disabled");var field=option.closest(".fieldCell,.cb_field");if(field.length){var shown=field.find('input,option[value!=""]');var hidden=field.find('input.optionDisabled,option[value!=""].optionDisabled');if(shown.length&&hidden.length&&(shown.length==hidden.length)){var row=field.parent();if(row.length&&row.attr("id")){var field_id=row.attr("id").replace(/cbfr_|cbfrd_|__verify|__strength/,"");if(field_id&&(fields.indexOf(field_id)==-1)){fields.push(field_id)}}}}}}}if(fields.length){hideFields(fields,reset)}}function disableTab(tab){if(tab){var tab_id=tab.replace(/cbtf_/,"");var tab=$("#cbtf_"+tab_id);var panel_id=null;if(!tab.children().not(".displayDisabled").length){if(($.fn.tabs!="undefined")&&$(".cbRegistration").length){panel_id=tab.parent(".ui-tabs-panel").attr("id");if(panel_id){$("#registrationTable #stepbystep").tabs("disable",panel_id.replace(/step-/,""))}}else{if($(".cbEditProfile").length){setTimeout(function(){$("#cbtab"+tab_id).parent(".tab-pane").find(".tab-row").children().eq(($("#cbtab"+tab_id).index()-1)).addClass("displayDisabled")},1)}}tab.addClass("displayDisabled")}else{if(($.fn.tabs!="undefined")&&$(".cbRegistration").length){panel_id=tab.parent(".ui-tabs-panel").attr("id");if(panel_id){$("#registrationTable #stepbystep").tabs("enable",panel_id.replace(/step-/,""))}}else{if($(".cbEditProfile").length){setTimeout(function(){$("#cbtab"+tab_id).parent(".tab-pane").find(".tab-row").children().eq(($("#cbtab"+tab_id).index()-1)).removeClass("displayDisabled")},1)}}tab.removeClass("displayDisabled")}}}function requireFields(fields,icon){if(fields){for(i=0;i<fields.length;i++){var field_id=fields[i];var field=$("#cbfr_"+field_id+",#cbfrd_"+field_id+",#cbfr_"+field_id+"__verify,#cbfr_"+field_id+"__strength");field.find(".fieldCell,.cb_field").find("input,select,textarea").not('[type="hidden"],[type="submit"],[type="button"]').addClass("required").attr("mosReq","1");field.find(".cbFieldIcons").find('img[src*="required"]').remove();field.find(".cbFieldIcons").prepend(icon)}}}function nonrequireFields(fields){if(fields){for(i=0;i<fields.length;i++){var field_id=fields[i];var field=$("#cbfr_"+field_id+",#cbfrd_"+field_id+",#cbfr_"+field_id+"__verify,#cbfr_"+field_id+"__strength");field.find(".fieldCell,.cb_field").find("input.required,select.required,textarea.required").removeClass("required").attr("mosReq","0");field.find(".cbFieldIcons").find('img[src*="required"]').remove();field.removeClass("cbValidationError").find(".cbValidationError").removeClass("cbValidationError").find(".cbValidationErrortext").removeClass("cbValidationErrortext");field.find(".cb_result_warning").remove()}}}function showTabs(tabs){if(tabs){for(i=0;i<tabs.length;i++){var tab_id=tabs[i];var tab=$("#cbtf_"+tab_id);var container=tab.find(".fieldCell,.cb_field");if(($.fn.tabs!="undefined")&&$(".cbRegistration").length){var panel_id=tab.parent(".ui-tabs-panel").attr("id");if(panel_id){$("#registrationTable #stepbystep").tabs("enable",panel_id.replace(/step-/,""))}}else{if($(".cbEditProfile").length){setTimeout(function(){$("#cbtab"+tab_id).parent(".tab-pane").find(".tab-row").children().eq(($("#cbtab"+tab_id).index()-1)).removeClass("displayDisabled")},1)}}container.find("input.tabDisabled,select.tabDisabled,textarea.tabDisabled").removeClass("tabDisabled").addClass("required").attr("mosReq","1");tab.removeClass("displayDisabled")}}}function hideTabs(tabs,reset){if(tabs){for(i=0;i<tabs.length;i++){var tab_id=tabs[i];var tab=$("#cbtf_"+tab_id);var container=tab.find(".fieldCell,.cb_field");if(($.fn.tabs!="undefined")&&$(".cbRegistration").length){var panel_id=tab.parent(".ui-tabs-panel").attr("id");if(panel_id){$("#registrationTable #stepbystep").tabs("disable",panel_id.replace(/step-/,""))}}else{if($(".cbEditProfile").length){setTimeout(function(){$("#cbtab"+tab_id).parent(".tab-pane").find(".tab-row").children().eq(($("#cbtab"+tab_id).index()-1)).addClass("displayDisabled")},1)}}if(reset==1){var inputs=container.find("input,select,textarea").not('[type="hidden"],[type="submit"],[type="button"]');inputs.val("");if(inputs.is('[type="checkbox"],[type="radio"]')){inputs.attr("checked","")}}container.find("input.required,select.required,textarea.required").not('[type="hidden"],[type="submit"],[type="button"]').removeClass("required").addClass("tabDisabled").attr("mosReq","0");tab.addClass("displayDisabled")}}}function getValue(field,fields){var value="";if(typeof field=="object"){var type=field.attr("type");var name=field.attr("name");if((type=="select-one")&&name.match(/_choice/i)){var selected=field.val();if(((selected=="upload")||(selected=="gallery")||field.parents(".fieldCell,.cb_field").find("a").length)&&(selected!="delete")){value="1"}}else{if((type=="file")&&name.match(/_file/i)){var image=field.parents(".fieldCell,.cb_field").find("select").val();if(((image=="upload")||(image=="gallery")||field.parents(".fieldCell,.cb_field").find("a").length)&&(image!="delete")){value="1"}}else{var values=new Array();fields.each(function(){var val=$(this).val();if(val){if((type=="checkbox")||(type=="radio")){if($(this).is(":checked")){values.push(val)}}else{if(type=="select-multiple"){if(!$.isArray(val)){values=val.split(",")}else{values=val}}else{values.push(val)}}}});if(values.length){values=$.grep(values,function(s){return s.length!=0})}value=values.join("|*|")}}}else{value=field}return value}function getMatch(value,operator,input){value=$.trim(value);input=$.trim(input);var match=false;switch(operator){case 1:match=(value!=input);break;case 2:match=(value>input);break;case 3:match=(value<input);break;case 4:match=(value>=input);break;case 5:match=(value<=input);break;case 6:match=(!value.length);break;case 7:match=(value.length);break;case 8:match=(value.indexOf(input)!=-1);break;case 9:match=(value.indexOf(input)==-1);break;case 10:match=(value.match(eval(input)));break;case 11:match=(!value.match(eval(input)));break;case 0:default:match=(value==input);break}return match}})(jQuery);