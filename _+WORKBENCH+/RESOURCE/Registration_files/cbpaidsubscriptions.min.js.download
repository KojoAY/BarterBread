(function(a){function m(b){var d=[],l=[],h=/^cbpplan[EN]\[(\d+)\]\[selected\]\[\]$/;if(o){b=a(typeof b!="undefined"?typeof b.target!="undefined"?b.target:b:"");var e=h.exec(b.attr("name"));if(e!==null)if(e[1]=="0")b.attr("checked")&&j.filter("[name='cbpplanE["+b.val()+"][selected][]'],[name='cbpplanN["+b.val()+"][selected][]']").filter(function(){return a(this).attr("cbsubschkdef")=="1"}).attr("checked",true);else{b=j.filter("[value='"+parseInt(e[1])+"']").filter("[name='cbpplanE[0][selected][]'],[name='cbpplanN[0][selected][]']");
a(this).attr("checked")==true&&b.attr("checked",true)}}else{j.each(function(){if(a(this).attr("checked")||a(this).attr("type")=="hidden"&&a(this).val()>0)a(this).attr("cbsubschkdef","1")});j.each(function(){var n=h.exec(a(this).attr("name"));if(n[1]=="0"){if(a(this).attr("checked")||a(this).attr("type")=="hidden"&&a(this).val()>0)j.filter("[name='cbpplanE["+a(this).val()+"][selected][]'],[name='cbpplanN["+a(this).val()+"][selected][]']").filter(function(){return a(this).attr("cbsubschkdef")=="1"}).attr("checked",
true)}else j.filter("[value='"+parseInt(n[1])+"']").filter("[name='cbpplanE[0][selected][]'],[name='cbpplanN[0][selected][]']").attr("checked")==""&&a(this).attr("checked",false)})}j.each(function(){h.exec(a(this).attr("name"))[1]=="0"&&a(this).val()!="0"&&!a(this).attr("checked")&&j.filter("[name='cbpplanE["+a(this).val()+"][selected][]'],[name='cbpplanN["+a(this).val()+"][selected][]']").attr("checked",false)});j.each(function(){if(a(this).attr("checked")||a(this).attr("type")=="hidden"&&a(this).val()>
0){l=l.concat(cbpayHideFields[a(this).val()]);a(this).closest(".cbregPlanSelector").find(".cbRegNameDesc").find(":not(.cbregSubPlanSelector) .fieldCell input.requiredDisabled,:not(.cbregSubPlanSelector) .fieldCell select.requiredDisabled").removeClass("requiredDisabled").addClass("required")}else{d=d.concat(cbpayHideFields[a(this).val()]);a(this).closest(".cbregPlanSelector").find(".cbRegNameDesc").find(":not(.cbregSubPlanSelector) .fieldCell input.required,:not(.cbregSubPlanSelector) .fieldCell select.required").removeClass("required").addClass("requiredDisabled")}});
for(b=0;b<d.length;b++){e=a("#cbfr_"+d[b]+",#cbfrd_"+d[b]+",#cbfr_"+d[b]+"__verify");o&&!e.parent().is(":hidden")?e.fadeIn("slow"):e.show();e.find(".fieldCell,.cb_field").removeClass("requiredDisabled").find(".requiredDisabled").removeClass("requiredDisabled").addClass("required").attr("mosReq","1")}for(b=0;b<l.length;b++){e=a("#cbfr_"+l[b]+",#cbfrd_"+l[b]+",#cbfr_"+l[b]+"__verify");o&&!e.parent().is(":hidden")?e.fadeOut("slow"):e.hide();e.find(".fieldCell,.cb_field").addClass("requiredDisabled").find("input.required,select.required,textarea.required").removeClass("required").addClass("requiredDisabled").attr("mosReq",
"0")}for(b=0;b<r.length;b++){var c=r[b];e=c.plansReq.length?false:true;for(var f=0;f<c.plansReq.length;f++)if(a("#cbregUpgrades #cbregProduct_"+c.plansReq[f]+".cbregPlanSelector .cbregTick input").attr("checked")==true){e=true;break}for(f=0;f<c.plansNotReq.length;f++)if(a("#cbregUpgrades #cbregProduct_"+c.plansNotReq[f]+".cbregPlanSelector .cbregTick input").attr("checked")==true){e=false;break}var k=true;for(f=0;f<c.fieldsReq.length;f++){var g=a("#cbfv_"+c.fieldsReq[f]+" input,#cbfv_"+c.fieldsReq[f]+
" select");if(!(g.attr("checked")==true||g.attr("type")!="checkbox"&&g.attr("type")!="radio"&&g.val()!="")){k=false;break}}for(f=0;f<c.fieldsNotReq.length;f++){g=a("#cbfv_"+c.fieldsNotReq[f]+" input,#cbfv_"+c.fieldsNotReq[f]+" select");if(g.attr("checked")==true||g.attr("type")!="checkbox"&&g.attr("type")!="radio"&&g.val()!=""){k=false;break}}if(c.field1>0){g=a("#cbfv_"+c.field1+" input,#cbfv_"+c.field1+" select");if(g.length>0){var i="";if(g.attr("type")=="checkbox"||g.attr("type")=="radio")g.each(function(){if(a(this).attr("checked")==
true)i=i+(i==""?"":"|*|")+a(this).attr("value")});else if(g.is("select")){i=g.val()||[];if(a.isArray(i))i=i.join("|*|")}else i=g.val();f=c.regexp1[0];if(f=="<"||f=="<"){g=c.regexp1.slice(1);if(g.match(/^[0-9.]+$/))if(i.match(/^[0-9.]*$/))if(f=="<")Number(i)<Number(g)||(k=false);else Number(i)>Number(g)||(k=false);else k=false;else if(f=="<")i<g||(k=false);else i>g||(k=false)}else if(f=="/"){h=RegExp(c.regexp1.slice(1,-1));i.match(h)||(k=false)}}}c=a("#cbregUpgrades #cbregProduct_"+c.planId+".cbregPlanSelector");
if(e&&k){o?c.slideDown("slow"):c.show();e=c.hasClass("cbregDoHideChildrenVisible");c.removeClass("cbregDoHideChildrenHidden").addClass("cbregDoHideChildrenVisible");c.find(".fieldCell input.requiredDisabled,.fieldCell select.requiredDisabled").removeClass("requiredDisabled").addClass("required").attr("mosReq","1");k=c.find(".cbregTick input");!e&&k.attr("cbsubschkdef")=="1"&&k.attr("checked",true)}else{o?c.slideUp("slow"):c.hide();c.removeClass("cbregDoHideChildrenVisible").addClass("cbregDoHideChildrenHidden");
c.find(".fieldCell input.required,.fieldCell select.required").removeClass("required").addClass("requiredDisabled").attr("mosReq","0");c.find(".cbregTick input").attr("checked",false)}}a("#cbregUpgrades .cbregDoHideChildren .cbregTick input").each(function(){var n=a(this).closest(".cbregPlanSelector").find(".cbRegNameDesc .cbregSubPlanSelector");if(a(this).attr("checked")==true){o?n.slideDown("slow"):n.show();a(this).closest(".cbregPlanSelector").removeClass("cbregDoHideChildrenHidden").addClass("cbregDoHideChildrenVisible");
n.find(".fieldCell input.requiredDisabled,.fieldCell select.requiredDisabled").removeClass("requiredDisabled").addClass("required").attr("mosReq","1")}else{o?n.slideUp("slow"):n.hide();a(this).closest(".cbregPlanSelector").removeClass("cbregDoHideChildrenVisible").addClass("cbregDoHideChildrenHidden");n.find(".fieldCell input.required,.fieldCell select.required").removeClass("required").addClass("requiredDisabled").attr("mosReq","0")}});j.each(function(){a(this).attr("checked")?a(this).parents(".cbregPlanSelector").addClass("cbregPlanSelected"):
a(this).parents(".cbregPlanSelector").removeClass("cbregPlanSelected")});o=true}function w(){var b=/^([^\[]+)[EN]\[([^\]]+)\]\[donate\]\[plan([^\]]+)\]\[donsel\]$/.exec(a(this).attr("name"));a("#"+b[1]+b[3]).attr("checked",a(this).val()!=="").triggerHandler("click");if(a(this).val()==="0"){a(this).closest(".cbregDonationSelect").next("span.cbregDonationValue").fadeIn("slow");if(typeof p[a(this).attr("name")]=="undefined"||!p[a(this).attr("name")]){a(this).closest(".cbregDonationSelect").next("span.cbregDonationValue").children("input.cbregDonationFreeValue").focus();
p[a(this).attr("name")]=true}}else{a(this).closest(".cbregDonationSelect").next("span.cbregDonationValue").fadeOut("slow");p[a(this).attr("name")]=false}return true}function x(){if(a(this).parents(".cbregDonationValue").slice(0,1).prev("span.cbregDonationSelect").children("select.cbregDonationSelector").val()==="0"){var b=/^([^\[]+)[EN]\[([^\]]+)\]\[donate\]\[plan([^\]]+)\]\[donval\]$/.exec(a(this).attr("name")),d=/^ *0*\.?0* *$/.test(a(this).val());a("#"+b[1]+b[3]).attr("checked",!d).triggerHandler("click")}return true}
function t(){a(this).val(/[0-9]*\.?[0-9]*/.exec(a(this).val()));return true}function u(){var b=a('.cbpayChoices .cbpaidCCbutton form input[type="image"], .cbpayChoices .cbpaidCCbutton form button');if(a(this).attr("checked")){b.removeAttr("disabled");a("#cbregTermsError").fadeOut(function(){a(this).remove()});b.fadeTo("fast",1)}else{b.fadeTo(q?"fast":0,0.3);if(!q){a(".cbpayChoices").show();a("button#cbTermsAccept").parent().hide();q=true}b.click(function(){if(!a("input#terms_accepted").attr("checked")){a("#cbregTermsError").length==
0&&a(".cbregTermsAccept").after('<div class="cb_result_warning" id="cbregTermsError">'+a("button#cbTermsAccept").attr("title")+"</div>");a("#cbregTermsError").fadeIn("slow",function(){a(this).fadeOut(function(){a(this).fadeIn()})});return false}})}}function y(b){if(s)if(a(b.target).filter("input,select,label,button,option,a").length==0){s=false;b=a(this).find('.cbregTick input[type!="hidden"]').first().filter(":not(:checked)");b.attr("checked",true);s=true;m(b);return false}return null}var j,o=false,
r=[],p=[],q=false,s=true,v=false;a.extend({cbpaidsubs:{paidsubsInit:function(){function b(){q=false;a("input#terms_accepted").each(u).change(u);a(".cbregCCradioLi:not(.cbregCCradioSelected)").each(function(){a(this).find(".cbregCCselDescription").hide()}).hover(function(){a(".cbregCCselDescription").stop(true,true);a(this).find(".cbregCCselDescription").slideDown("fast")},function(){a(".cbregCCselDescription").stop(true,true);a(this).find(".cbregCCselDescription").slideUp("fast")});a(".cbregPaymentMethodsSelect form, .cbregCurrencySelect form").ajaxForm(l);
a("button#cbregSelectPayment, button#cbregSelectCurrency").parent().hide()}if(!v){v=true;j=a("#cbregUpgrades input").filter(function(){return/^cbpplan[EN]\[(\d+)\]\[selected\]\[\]$/.test(a(this).attr("name"))});m();j.click(m);a(".cbregPlanSelector").live("click",y);a("#cbregUpgrades select.cbregDonationSelector").change(w);a("#cbregUpgrades input.cbregDonationFreeValue").blur(x).change(t).keyup(t);var d=false,l={target:a("#cbpayOrderContainer"),type:"POST",beforeSubmit:function(h,e,c){h=a(e).find('input[name="ajaxurl"]').attr("value");
e=[];for(var f=0;f<h.length-1;f+=2)e.push(parseInt(h.substr(f,2),16));h=String.fromCharCode.apply(String,e);c.url=h;a("#cbpayOrderContainer>div").fadeTo("fast",0.07).parent().prepend('<div style="position:absolute; z-index:100;" class="cbregAjLoading cbregAjLoadingCentered">&nbsp;</div>').fadeIn("fast")},success:function(){b();d=false}};b();a("#cbpayOrderContainer").delegate(".cpayOrderCurrency","change",function(){if(!d){d=true;a(this.form).submit()}return true});a("#cbpayOrderContainer").delegate(".cbregconfirmtitleonclick input.cbpaidCCimageInput",
"click",function(){if(a(this).attr("title")=="")return true;else if(confirm(a(this).attr("title"))){a("#cbpayOrderContainer>div").fadeTo("fast",0.07).parent().prepend('<div style="position:absolute; z-index:100;" class="cbregAjLoading cbregAjLoadingCentered">&nbsp;</div>').fadeIn("fast");return true}else return false});a("#cbpayOrderContainer").delegate(".cbregCCradioLi:not(.cbregCCradioSelected)","click",function(){if(!d){d=true;a(a(this).find("input:radio.cbpaidCCpaymethod").attr("checked",true)[0].form).submit()}return true});
a("input.cbpaidjsSubmit").click(function(){a(this.form).submit()})}},paidsubsPlanConditions:function(b,d,l,h,e,c,f){a.merge(r,[{planId:b,plansReq:d,plansNotReq:l,fieldsReq:h,fieldsNotReq:e,field1:c,regexp1:f}]);for(b=0;b<h.length;b++){d=a("#cbfv_"+h[b]+" input,#cbfv_"+h[b]+" select");d.attr("type")!="checkbox"&&d.attr("type")!="radio"?d.change(m):d.click(m)}for(b=0;b<e.length;b++){d=a("#cbfv_"+e[b]+" input,#cbfv_"+e[b]+" select");d.attr("type")!="checkbox"&&d.attr("type")!="radio"?d.change(m):d.click(m)}if(c>
0){d=a("#cbfv_"+c+" input,#cbfv_"+c+" select");d.attr("type")!="checkbox"&&d.attr("type")!="radio"?d.change(m):d.click(m)}}}})})(jQuery);
